{"version":3,"file":"Main-dbg.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","formatter","__formatter","Main","extend","constructor","prototype","apply","arguments","onInit","_onInit","Model","JSONModel","setData","Factory","isFactory","Products","Materials","Cost","ProductionCap","Product","isProduct","BoughtBy","ProducedBy","Dangerous","Illegal","AvgPrice","Level","getView","setModel","getRouter","getRoute","attachPatternMatched","onPatternMatched","inputG","byId","inputF","setFilterFunction","sTerm","oItem","getText","match","RegExp","buildProdLine","_buildProdLine","event","navTo","_onPatternMatched","getData","ViewModel","getModel","query","getParameter","factory","setProperty","replace","submitFactory","good","submitGood","error","console","_submitGood","Data","getProduct","getProperty","getCustomersOfProduct","Name","getFactoriesFromProduct","_submitFactory","getFactory","getMaterialsForFactory","getProductsFromFactory","onSelectNewFactory","_onSelectNewFactory","onSelectNewProduct","_onSelectNewProduct","FormatCredits","_FormatCredits","number","format","NumberFormat","getIntegerInstance","groupingEnabled","groupingSize","groupingSeparator","showAllProducts","_showAllProducts","that","data","Goods","showAllFactories","_showAllFactories","Factories"],"sources":["../../src/controller/Main.controller.ts"],"sourcesContent":["import MessageBox from \"sap/m/MessageBox\";\r\nimport BaseController from \"./BaseController\";\r\nimport formatter from \"../model/formatter\";\r\nimport Event from \"sap/ui/base/Event\";\r\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\r\nimport Input from \"sap/m/Input\";\r\nimport SuggestionItem from \"sap/m/SuggestionItem\";\r\nimport NumberFormat from \"sap/ui/core/format/NumberFormat\";\r\n\r\n/**\r\n * @namespace de.henloh.prodts.controller\r\n */\r\nexport default class Main extends BaseController {\r\n\tprivate formatter = formatter;\r\n\r\n\tpublic onInit(): void {\r\n\t\tvar Model = new JSONModel();\r\n\t\tModel.setData({\r\n\t\t\tFactory: \"\",\r\n\t\t\tisFactory: false,\r\n\t\t\tProducts: [],\r\n\t\t\tMaterials: [],\r\n\t\t\tCost: 0,\r\n\t\t\tProductionCap: 0,\r\n\t\t\t\r\n\t\t\tProduct: \"\",\r\n\t\t\tisProduct: false,\r\n\t\t\tBoughtBy: [],\r\n\t\t\tProducedBy: [],\r\n\t\t\tDangerous: false,\r\n\t\t\tIllegal: false,\r\n\t\t\tAvgPrice: 0,\r\n\t\t\tLevel: 0\r\n\t\t});\r\n\t\tthis.getView().setModel(Model, \"View\");\r\n\t\tthis.getRouter().getRoute(\"main\").attachPatternMatched(this.onPatternMatched, this);\r\n\r\n\t\tvar inputG = this.byId(\"productInput\") as Input\r\n\t\tvar inputF = this.byId(\"factoryInput\") as Input\r\n\t\t//@ts-ignore\r\n\t\tinputG.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t\t//@ts-ignore\r\n\t\tinputF.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t}\r\n\tpublic buildProdLine(event: Event): void {\r\n\t\tthis.getRouter().navTo(\"productionLine\");\r\n\t}\r\n\tpublic onPatternMatched(event: Event): void {\r\n\t\tvar Model = new JSONModel()\r\n\t\tModel.setData(this.getData())\r\n\t\tthis.getView().setModel(Model, \"Data\")\r\n\r\n\t\tvar ViewModel = this.getView().getModel(\"View\") as JSONModel;\r\n\r\n\t\ttry {\r\n\t\t\tvar query = event.getParameter(\"arguments\")[\"?query\"];\r\n\t\t\tif (query.factory) {\r\n\t\t\t\tViewModel.setProperty(\"/Factory\", query.factory.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitFactory(event);\r\n\t\t\t}\r\n\t\t\tif (query.good) {\r\n\t\t\t\tViewModel.setProperty(\"/Product\", query.good.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitGood(event);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t}\r\n\t}\r\n\tpublic submitGood(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Product = Data.getProduct(Model.getProperty(\"/Product\"));\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", Product.Illegal);\r\n\t\tModel.setProperty(\"/Dangerous\", Product.Dangerous);\r\n\t\tModel.setProperty(\"/AvgPrice\", Product.AvgPrice);\r\n\t\tModel.setProperty(\"/Level\", Product.Level);\r\n\t\tModel.setProperty(\"/BoughtBy\", Data.getCustomersOfProduct(Product.Name));\r\n\t\tModel.setProperty(\"/ProducedBy\", Data.getFactoriesFromProduct(Product.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tgood: Model.getProperty(\"/Product\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic submitFactory(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Factory = Data.getFactory(Model.getProperty(\"/Factory\"));\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", Factory.Cost);\r\n\t\tModel.setProperty(\"/ProductionCap\", Factory.ProductionCap);\r\n\t\tModel.setProperty(\"/Materials\", Data.getMaterialsForFactory(Factory.Name));\r\n\t\tModel.setProperty(\"/Products\", Data.getProductsFromFactory(Factory.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tfactory: Model.getProperty(\"/Factory\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic onSelectNewFactory(event: Event, Factory: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Factory\", Factory);\r\n\t\tthis.submitFactory(event);\r\n\t}\r\n\tpublic onSelectNewProduct(event: Event, Product: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Product\", Product);\r\n\t\tthis.submitGood(event);\r\n\t}\r\n\tpublic FormatCredits(number: float): string{\r\n\t\tvar format: NumberFormat = NumberFormat.getIntegerInstance({\r\n\t\t\tgroupingEnabled: true,\r\n\t\t\tgroupingSize: 3,\r\n\t\t\tgroupingSeparator: \",\"\r\n\t\t});\r\n\t\treturn format.format(number);\r\n\t}\r\n\tpublic showAllProducts(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", \"\");\r\n\t\tModel.setProperty(\"/ProductionCap\", \"\");\r\n\t\tModel.setProperty(\"/Materials\", []);\r\n\t\tvar data = that.getData().Goods;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/Products\", data);\r\n\t}\r\n\tpublic showAllFactories(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", false);\r\n\t\tModel.setProperty(\"/Dangerous\", false);\r\n\t\tModel.setProperty(\"/AvgPrice\", \"\");\r\n\t\tModel.setProperty(\"/Level\", \"\");\r\n\t\tModel.setProperty(\"/BoughtBy\", []);\r\n\t\tvar data = that.getData().Factories;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/ProducedBy\", data);\r\n\t}\r\n}\r\n"],"mappings":"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"}