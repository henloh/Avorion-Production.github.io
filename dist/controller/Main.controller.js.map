{"version":3,"file":"Main.controller.js","names":["BaseController","formatter","Main","onInit","Model","JSONModel","setData","Factory","isFactory","Products","Materials","Cost","ProductionCap","Product","isProduct","BoughtBy","ProducedBy","Dangerous","Illegal","AvgPrice","Level","getView","setModel","getRouter","getRoute","attachPatternMatched","onPatternMatched","inputG","byId","inputF","setFilterFunction","sTerm","oItem","getText","match","RegExp","buildProdLine","event","navTo","getData","ViewModel","getModel","query","getParameter","factory","setProperty","replace","submitFactory","good","submitGood","error","console","Data","getProduct","getProperty","getCustomersOfProduct","Name","getFactoriesFromProduct","getFactory","getMaterialsForFactory","getProductsFromFactory","onSelectNewFactory","onSelectNewProduct","FormatCredits","number","format","NumberFormat","getIntegerInstance","groupingEnabled","groupingSize","groupingSeparator","showAllProducts","that","data","Goods","showAllFactories","Factories"],"sources":["../../src/controller/Main.controller.ts"],"sourcesContent":["import MessageBox from \"sap/m/MessageBox\";\r\nimport BaseController from \"./BaseController\";\r\nimport formatter from \"../model/formatter\";\r\nimport Event from \"sap/ui/base/Event\";\r\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\r\nimport Input from \"sap/m/Input\";\r\nimport SuggestionItem from \"sap/m/SuggestionItem\";\r\nimport NumberFormat from \"sap/ui/core/format/NumberFormat\";\r\n\r\n/**\r\n * @namespace de.henloh.prodts.controller\r\n */\r\nexport default class Main extends BaseController {\r\n\tprivate formatter = formatter;\r\n\r\n\tpublic onInit(): void {\r\n\t\tvar Model = new JSONModel();\r\n\t\tModel.setData({\r\n\t\t\tFactory: \"\",\r\n\t\t\tisFactory: false,\r\n\t\t\tProducts: [],\r\n\t\t\tMaterials: [],\r\n\t\t\tCost: 0,\r\n\t\t\tProductionCap: 0,\r\n\t\t\t\r\n\t\t\tProduct: \"\",\r\n\t\t\tisProduct: false,\r\n\t\t\tBoughtBy: [],\r\n\t\t\tProducedBy: [],\r\n\t\t\tDangerous: false,\r\n\t\t\tIllegal: false,\r\n\t\t\tAvgPrice: 0,\r\n\t\t\tLevel: 0\r\n\t\t});\r\n\t\tthis.getView().setModel(Model, \"View\");\r\n\t\tthis.getRouter().getRoute(\"main\").attachPatternMatched(this.onPatternMatched, this);\r\n\r\n\t\tvar inputG = this.byId(\"productInput\") as Input\r\n\t\tvar inputF = this.byId(\"factoryInput\") as Input\r\n\t\tinputG.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t\tinputF.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t}\r\n\tpublic buildProdLine(event: Event): void {\r\n\t\tthis.getRouter().navTo(\"productionLine\");\r\n\t}\r\n\tpublic onPatternMatched(event: Event): void {\r\n\t\tvar Model = new JSONModel()\r\n\t\tModel.setData(this.getData())\r\n\t\tthis.getView().setModel(Model, \"Data\")\r\n\r\n\t\tvar ViewModel = this.getView().getModel(\"View\") as JSONModel;\r\n\r\n\t\ttry {\r\n\t\t\tvar query = event.getParameter(\"arguments\")[\"?query\"];\r\n\t\t\tif (query.factory) {\r\n\t\t\t\tViewModel.setProperty(\"/Factory\", query.factory.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitFactory(event);\r\n\t\t\t}\r\n\t\t\tif (query.good) {\r\n\t\t\t\tViewModel.setProperty(\"/Product\", query.good.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitGood(event);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t}\r\n\t}\r\n\tpublic submitGood(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Product = Data.getProduct(Model.getProperty(\"/Product\"));\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", Product.Illegal);\r\n\t\tModel.setProperty(\"/Dangerous\", Product.Dangerous);\r\n\t\tModel.setProperty(\"/AvgPrice\", Product.AvgPrice);\r\n\t\tModel.setProperty(\"/Level\", Product.Level);\r\n\t\tModel.setProperty(\"/BoughtBy\", Data.getCustomersOfProduct(Product.Name));\r\n\t\tModel.setProperty(\"/ProducedBy\", Data.getFactoriesFromProduct(Product.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tgood: Model.getProperty(\"/Product\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic submitFactory(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Factory = Data.getFactory(Model.getProperty(\"/Factory\"));\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", Factory.Cost);\r\n\t\tModel.setProperty(\"/ProductionCap\", Factory.ProductionCap);\r\n\t\tModel.setProperty(\"/Materials\", Data.getMaterialsForFactory(Factory.Name));\r\n\t\tModel.setProperty(\"/Products\", Data.getProductsFromFactory(Factory.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tfactory: Model.getProperty(\"/Factory\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic onSelectNewFactory(event: Event, Factory: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Factory\", Factory);\r\n\t\tthis.submitFactory(event);\r\n\t}\r\n\tpublic onSelectNewProduct(event: Event, Product: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Product\", Product);\r\n\t\tthis.submitGood(event);\r\n\t}\r\n\tpublic FormatCredits(number: float): string{\r\n\t\tvar format: NumberFormat = NumberFormat.getIntegerInstance({\r\n\t\t\tgroupingEnabled: true,\r\n\t\t\tgroupingSize: 3,\r\n\t\t\tgroupingSeparator: \",\"\r\n\t\t});\r\n\t\treturn format.format(number);\r\n\t}\r\n\tpublic showAllProducts(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", \"\");\r\n\t\tModel.setProperty(\"/ProductionCap\", \"\");\r\n\t\tModel.setProperty(\"/Materials\", []);\r\n\t\tvar data = that.getData().Goods;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/Products\", data);\r\n\t}\r\n\tpublic showAllFactories(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", false);\r\n\t\tModel.setProperty(\"/Dangerous\", false);\r\n\t\tModel.setProperty(\"/AvgPrice\", \"\");\r\n\t\tModel.setProperty(\"/Level\", \"\");\r\n\t\tModel.setProperty(\"/BoughtBy\", []);\r\n\t\tvar data = that.getData().Factories;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/ProducedBy\", data);\r\n\t}\r\n}\r\n"],"mappings":";;;;QACOA,cAAc;EAAA,MACdC,SAAS;EAOhB;AACA;AACA;EAFA,MAGqBC,IAAI,GAASF,cAAc;IAAA;MAAA;MAAA,KACvCC,SAAS,GAAGA,SAAS;IAAA;IAEtBE,MAAM,qBAAS;MACrB,IAAIC,KAAK,GAAG,IAAIC,SAAS,EAAE;MAC3BD,KAAK,CAACE,OAAO,CAAC;QACbC,OAAO,EAAE,EAAE;QACXC,SAAS,EAAE,KAAK;QAChBC,QAAQ,EAAE,EAAE;QACZC,SAAS,EAAE,EAAE;QACbC,IAAI,EAAE,CAAC;QACPC,aAAa,EAAE,CAAC;QAEhBC,OAAO,EAAE,EAAE;QACXC,SAAS,EAAE,KAAK;QAChBC,QAAQ,EAAE,EAAE;QACZC,UAAU,EAAE,EAAE;QACdC,SAAS,EAAE,KAAK;QAChBC,OAAO,EAAE,KAAK;QACdC,QAAQ,EAAE,CAAC;QACXC,KAAK,EAAE;MACR,CAAC,CAAC;MACF,IAAI,CAACC,OAAO,EAAE,CAACC,QAAQ,CAAClB,KAAK,EAAE,MAAM,CAAC;MACtC,IAAI,CAACmB,SAAS,EAAE,CAACC,QAAQ,CAAC,MAAM,CAAC,CAACC,oBAAoB,CAAC,IAAI,CAACC,gBAAgB,EAAE,IAAI,CAAC;MAEnF,IAAIC,MAAM,GAAG,IAAI,CAACC,IAAI,CAAC,cAAc,CAAU;MAC/C,IAAIC,MAAM,GAAG,IAAI,CAACD,IAAI,CAAC,cAAc,CAAU;MAC/CD,MAAM,CAACG,iBAAiB,CAAC,UAAUC,KAAa,EAAEC,KAAoB,EAAE;QACvE,OAAOA,KAAK,CAACC,OAAO,EAAE,CAACC,KAAK,CAAC,IAAIC,MAAM,CAAC,GAAG,GAACJ,KAAK,EAAE,GAAG,CAAC,CAAC;MACzD,CAAC,CAAC;MACFF,MAAM,CAACC,iBAAiB,CAAC,UAAUC,KAAa,EAAEC,KAAoB,EAAE;QACvE,OAAOA,KAAK,CAACC,OAAO,EAAE,CAACC,KAAK,CAAC,IAAIC,MAAM,CAAC,GAAG,GAACJ,KAAK,EAAE,GAAG,CAAC,CAAC;MACzD,CAAC,CAAC;IACH,CAAC;IACMK,aAAa,0BAACC,KAAY,EAAQ;MACxC,IAAI,CAACd,SAAS,EAAE,CAACe,KAAK,CAAC,gBAAgB,CAAC;IACzC,CAAC;IACMZ,gBAAgB,6BAACW,KAAY,EAAQ;MAC3C,IAAIjC,KAAK,GAAG,IAAIC,SAAS,EAAE;MAC3BD,KAAK,CAACE,OAAO,CAAC,IAAI,CAACiC,OAAO,EAAE,CAAC;MAC7B,IAAI,CAAClB,OAAO,EAAE,CAACC,QAAQ,CAAClB,KAAK,EAAE,MAAM,CAAC;MAEtC,IAAIoC,SAAS,GAAG,IAAI,CAACnB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MAE5D,IAAI;QACH,IAAIC,KAAK,GAAGL,KAAK,CAACM,YAAY,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;QACrD,IAAID,KAAK,CAACE,OAAO,EAAE;UAClBJ,SAAS,CAACK,WAAW,CAAC,UAAU,EAAEH,KAAK,CAACE,OAAO,CAACE,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;UACtE,IAAI,CAACC,aAAa,CAACV,KAAK,CAAC;QAC1B;QACA,IAAIK,KAAK,CAACM,IAAI,EAAE;UACfR,SAAS,CAACK,WAAW,CAAC,UAAU,EAAEH,KAAK,CAACM,IAAI,CAACF,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;UACnE,IAAI,CAACG,UAAU,CAACZ,KAAK,CAAC;QACvB;MACD,CAAC,CAAC,OAAOa,KAAK,EAAE;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB;IACD,CAAC;IACMD,UAAU,uBAACZ,KAAY,EAAQ;MACrC,IAAIe,IAAI,GAAG,IAAI,CAACb,OAAO,EAAE;MACzB,IAAInC,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxD,IAAI5B,OAAO,GAAGuC,IAAI,CAACC,UAAU,CAACjD,KAAK,CAACkD,WAAW,CAAC,UAAU,CAAC,CAAC;MAC5DlD,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC;MACrCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC;MACtCzC,KAAK,CAACyC,WAAW,CAAC,UAAU,EAAEhC,OAAO,CAACK,OAAO,CAAC;MAC9Cd,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAEhC,OAAO,CAACI,SAAS,CAAC;MAClDb,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAEhC,OAAO,CAACM,QAAQ,CAAC;MAChDf,KAAK,CAACyC,WAAW,CAAC,QAAQ,EAAEhC,OAAO,CAACO,KAAK,CAAC;MAC1ChB,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAEO,IAAI,CAACG,qBAAqB,CAAC1C,OAAO,CAAC2C,IAAI,CAAC,CAAC;MACxEpD,KAAK,CAACyC,WAAW,CAAC,aAAa,EAAEO,IAAI,CAACK,uBAAuB,CAAC5C,OAAO,CAAC2C,IAAI,CAAC,CAAC;MAE5E,IAAI,CAACjC,SAAS,EAAE,CAACe,KAAK,CAAC,MAAM,EAAE;QAACI,KAAK,EAAE;UACtCM,IAAI,EAAE5C,KAAK,CAACkD,WAAW,CAAC,UAAU;QAClC;MAAC,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC;IACf,CAAC;IACMP,aAAa,0BAACV,KAAY,EAAQ;MACxC,IAAIe,IAAI,GAAG,IAAI,CAACb,OAAO,EAAE;MACzB,IAAInC,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxD,IAAIlC,OAAO,GAAG6C,IAAI,CAACM,UAAU,CAACtD,KAAK,CAACkD,WAAW,CAAC,UAAU,CAAC,CAAC;MAC5DlD,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC;MACtCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC;MACrCzC,KAAK,CAACyC,WAAW,CAAC,OAAO,EAAEtC,OAAO,CAACI,IAAI,CAAC;MACxCP,KAAK,CAACyC,WAAW,CAAC,gBAAgB,EAAEtC,OAAO,CAACK,aAAa,CAAC;MAC1DR,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAEO,IAAI,CAACO,sBAAsB,CAACpD,OAAO,CAACiD,IAAI,CAAC,CAAC;MAC1EpD,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAEO,IAAI,CAACQ,sBAAsB,CAACrD,OAAO,CAACiD,IAAI,CAAC,CAAC;MAEzE,IAAI,CAACjC,SAAS,EAAE,CAACe,KAAK,CAAC,MAAM,EAAE;QAACI,KAAK,EAAE;UACtCE,OAAO,EAAExC,KAAK,CAACkD,WAAW,CAAC,UAAU;QACrC;MAAC,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC;IACf,CAAC;IACMO,kBAAkB,+BAACxB,KAAY,EAAE9B,OAAe,EAAE;MACxD,IAAIH,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxDrC,KAAK,CAACyC,WAAW,CAAC,UAAU,EAAEtC,OAAO,CAAC;MACtC,IAAI,CAACwC,aAAa,CAACV,KAAK,CAAC;IAC1B,CAAC;IACMyB,kBAAkB,+BAACzB,KAAY,EAAExB,OAAe,EAAE;MACxD,IAAIT,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxDrC,KAAK,CAACyC,WAAW,CAAC,UAAU,EAAEhC,OAAO,CAAC;MACtC,IAAI,CAACoC,UAAU,CAACZ,KAAK,CAAC;IACvB,CAAC;IACM0B,aAAa,0BAACC,MAAa,EAAS;MAC1C,IAAIC,MAAoB,GAAGC,YAAY,CAACC,kBAAkB,CAAC;QAC1DC,eAAe,EAAE,IAAI;QACrBC,YAAY,EAAE,CAAC;QACfC,iBAAiB,EAAE;MACpB,CAAC,CAAC;MACF,OAAOL,MAAM,CAACA,MAAM,CAACD,MAAM,CAAC;IAC7B,CAAC;IACMO,eAAe,4BAAClC,KAAY,EAAQ;MAC1C,IAAIjC,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxD,IAAI+B,IAAI,GAAG,IAAI;MACfpE,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC;MACtCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC;MACrCzC,KAAK,CAACyC,WAAW,CAAC,OAAO,EAAE,EAAE,CAAC;MAC9BzC,KAAK,CAACyC,WAAW,CAAC,gBAAgB,EAAE,EAAE,CAAC;MACvCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,EAAE,CAAC;MACnC,IAAI4B,IAAI,GAAGD,IAAI,CAACjC,OAAO,EAAE,CAACmC,KAAK;MAC/B;MACAtE,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAE4B,IAAI,CAAC;IACrC,CAAC;IACME,gBAAgB,6BAACtC,KAAY,EAAQ;MAC3C,IAAIjC,KAAK,GAAG,IAAI,CAACiB,OAAO,EAAE,CAACoB,QAAQ,CAAC,MAAM,CAAc;MACxD,IAAI+B,IAAI,GAAG,IAAI;MACfpE,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC;MACrCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC;MACtCzC,KAAK,CAACyC,WAAW,CAAC,UAAU,EAAE,KAAK,CAAC;MACpCzC,KAAK,CAACyC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC;MACtCzC,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAE,EAAE,CAAC;MAClCzC,KAAK,CAACyC,WAAW,CAAC,QAAQ,EAAE,EAAE,CAAC;MAC/BzC,KAAK,CAACyC,WAAW,CAAC,WAAW,EAAE,EAAE,CAAC;MAClC,IAAI4B,IAAI,GAAGD,IAAI,CAACjC,OAAO,EAAE,CAACqC,SAAS;MACnC;MACAxE,KAAK,CAACyC,WAAW,CAAC,aAAa,EAAE4B,IAAI,CAAC;IACvC;EAAC;EAAA,OArImBvE,IAAI;AAAA"}