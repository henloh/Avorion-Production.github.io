{"version":3,"file":"Main.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","formatter","__formatter","Main","extend","constructor","prototype","apply","this","arguments","onInit","_onInit","Model","JSONModel","setData","Factory","isFactory","Products","Materials","Cost","ProductionCap","Product","isProduct","BoughtBy","ProducedBy","Dangerous","Illegal","AvgPrice","Level","getView","setModel","getRouter","getRoute","attachPatternMatched","onPatternMatched","inputG","byId","inputF","setFilterFunction","sTerm","oItem","getText","match","RegExp","buildProdLine","_buildProdLine","event","navTo","_onPatternMatched","getData","ViewModel","getModel","query","getParameter","factory","setProperty","replace","submitFactory","good","submitGood","error","console","_submitGood","Data","getProduct","getProperty","getCustomersOfProduct","Name","getFactoriesFromProduct","_submitFactory","getFactory","getMaterialsForFactory","getProductsFromFactory","onSelectNewFactory","_onSelectNewFactory","onSelectNewProduct","_onSelectNewProduct","FormatCredits","_FormatCredits","number","format","NumberFormat","getIntegerInstance","groupingEnabled","groupingSize","groupingSeparator","showAllProducts","_showAllProducts","that","data","Goods","showAllFactories","_showAllFactories","Factories"],"sources":["../../src/controller/Main.controller.ts"],"sourcesContent":["import MessageBox from \"sap/m/MessageBox\";\r\nimport BaseController from \"./BaseController\";\r\nimport formatter from \"../model/formatter\";\r\nimport Event from \"sap/ui/base/Event\";\r\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\r\nimport Input from \"sap/m/Input\";\r\nimport SuggestionItem from \"sap/m/SuggestionItem\";\r\nimport NumberFormat from \"sap/ui/core/format/NumberFormat\";\r\n\r\n/**\r\n * @namespace de.henloh.prodts.controller\r\n */\r\nexport default class Main extends BaseController {\r\n\tprivate formatter = formatter;\r\n\r\n\tpublic onInit(): void {\r\n\t\tvar Model = new JSONModel();\r\n\t\tModel.setData({\r\n\t\t\tFactory: \"\",\r\n\t\t\tisFactory: false,\r\n\t\t\tProducts: [],\r\n\t\t\tMaterials: [],\r\n\t\t\tCost: 0,\r\n\t\t\tProductionCap: 0,\r\n\t\t\t\r\n\t\t\tProduct: \"\",\r\n\t\t\tisProduct: false,\r\n\t\t\tBoughtBy: [],\r\n\t\t\tProducedBy: [],\r\n\t\t\tDangerous: false,\r\n\t\t\tIllegal: false,\r\n\t\t\tAvgPrice: 0,\r\n\t\t\tLevel: 0\r\n\t\t});\r\n\t\tthis.getView().setModel(Model, \"View\");\r\n\t\tthis.getRouter().getRoute(\"main\").attachPatternMatched(this.onPatternMatched, this);\r\n\r\n\t\tvar inputG = this.byId(\"productInput\") as Input\r\n\t\tvar inputF = this.byId(\"factoryInput\") as Input\r\n\t\t//@ts-ignore\r\n\t\tinputG.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t\t//@ts-ignore\r\n\t\tinputF.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t}\r\n\tpublic buildProdLine(event: Event): void {\r\n\t\tthis.getRouter().navTo(\"productionLine\");\r\n\t}\r\n\tpublic onPatternMatched(event: Event): void {\r\n\t\tvar Model = new JSONModel()\r\n\t\tModel.setData(this.getData())\r\n\t\tthis.getView().setModel(Model, \"Data\")\r\n\r\n\t\tvar ViewModel = this.getView().getModel(\"View\") as JSONModel;\r\n\r\n\t\ttry {\r\n\t\t\tvar query = event.getParameter(\"arguments\")[\"?query\"];\r\n\t\t\tif (query.factory) {\r\n\t\t\t\tViewModel.setProperty(\"/Factory\", query.factory.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitFactory(event);\r\n\t\t\t}\r\n\t\t\tif (query.good) {\r\n\t\t\t\tViewModel.setProperty(\"/Product\", query.good.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitGood(event);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t}\r\n\t}\r\n\tpublic submitGood(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Product = Data.getProduct(Model.getProperty(\"/Product\"));\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", Product.Illegal);\r\n\t\tModel.setProperty(\"/Dangerous\", Product.Dangerous);\r\n\t\tModel.setProperty(\"/AvgPrice\", Product.AvgPrice);\r\n\t\tModel.setProperty(\"/Level\", Product.Level);\r\n\t\tModel.setProperty(\"/BoughtBy\", Data.getCustomersOfProduct(Product.Name));\r\n\t\tModel.setProperty(\"/ProducedBy\", Data.getFactoriesFromProduct(Product.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tgood: Model.getProperty(\"/Product\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic submitFactory(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Factory = Data.getFactory(Model.getProperty(\"/Factory\"));\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", Factory.Cost);\r\n\t\tModel.setProperty(\"/ProductionCap\", Factory.ProductionCap);\r\n\t\tModel.setProperty(\"/Materials\", Data.getMaterialsForFactory(Factory.Name));\r\n\t\tModel.setProperty(\"/Products\", Data.getProductsFromFactory(Factory.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tfactory: Model.getProperty(\"/Factory\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic onSelectNewFactory(event: Event, Factory: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Factory\", Factory);\r\n\t\tthis.submitFactory(event);\r\n\t}\r\n\tpublic onSelectNewProduct(event: Event, Product: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Product\", Product);\r\n\t\tthis.submitGood(event);\r\n\t}\r\n\tpublic FormatCredits(number: float): string{\r\n\t\tvar format: NumberFormat = NumberFormat.getIntegerInstance({\r\n\t\t\tgroupingEnabled: true,\r\n\t\t\tgroupingSize: 3,\r\n\t\t\tgroupingSeparator: \",\"\r\n\t\t});\r\n\t\treturn format.format(number);\r\n\t}\r\n\tpublic showAllProducts(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", \"\");\r\n\t\tModel.setProperty(\"/ProductionCap\", \"\");\r\n\t\tModel.setProperty(\"/Materials\", []);\r\n\t\tvar data = that.getData().Goods;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/Products\", data);\r\n\t}\r\n\tpublic showAllFactories(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", false);\r\n\t\tModel.setProperty(\"/Dangerous\", false);\r\n\t\tModel.setProperty(\"/AvgPrice\", \"\");\r\n\t\tModel.setProperty(\"/Level\", \"\");\r\n\t\tModel.setProperty(\"/BoughtBy\", []);\r\n\t\tvar data = that.getData().Factories;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/ProducedBy\", data);\r\n\t}\r\n}\r\n"],"mappings":"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"}