{"version":3,"file":"Main.controller.js","names":["BaseController","formatter","Main","onInit","Model","JSONModel","setData","Factory","isFactory","Products","Materials","Cost","ProductionCap","Product","isProduct","BoughtBy","ProducedBy","Dangerous","Illegal","AvgPrice","Level","getView","setModel","getRouter","getRoute","attachPatternMatched","onPatternMatched","inputG","byId","inputF","setFilterFunction","sTerm","oItem","getText","match","RegExp","event","getData","ViewModel","getModel","query","getParameter","factory","setProperty","replace","submitFactory","good","submitGood","error","console","Data","getProduct","getProperty","getCustomersOfProduct","Name","getFactoriesFromProduct","navTo","getFactory","getMaterialsForFactory","getProductsFromFactory","onSelectNewFactory","onSelectNewProduct","FormatCredits","number","format","NumberFormat","getIntegerInstance","groupingEnabled","groupingSize","groupingSeparator","showAllProducts","that","data","Goods","showAllFactories","Factories"],"sources":["../../src/controller/Main.controller.ts"],"sourcesContent":["import MessageBox from \"sap/m/MessageBox\";\r\nimport BaseController from \"./BaseController\";\r\nimport formatter from \"../model/formatter\";\r\nimport Event from \"sap/ui/base/Event\";\r\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\r\nimport Input from \"sap/m/Input\";\r\nimport SuggestionItem from \"sap/m/SuggestionItem\";\r\nimport NumberFormat from \"sap/ui/core/format/NumberFormat\";\r\n\r\n/**\r\n * @namespace de.henloh.prodts.controller\r\n */\r\nexport default class Main extends BaseController {\r\n\tprivate formatter = formatter;\r\n\r\n\tpublic onInit(): void {\r\n\t\tvar Model = new JSONModel();\r\n\t\tModel.setData({\r\n\t\t\tFactory: \"\",\r\n\t\t\tisFactory: false,\r\n\t\t\tProducts: [],\r\n\t\t\tMaterials: [],\r\n\t\t\tCost: 0,\r\n\t\t\tProductionCap: 0,\r\n\t\t\t\r\n\t\t\tProduct: \"\",\r\n\t\t\tisProduct: false,\r\n\t\t\tBoughtBy: [],\r\n\t\t\tProducedBy: [],\r\n\t\t\tDangerous: false,\r\n\t\t\tIllegal: false,\r\n\t\t\tAvgPrice: 0,\r\n\t\t\tLevel: 0\r\n\t\t});\r\n\t\tthis.getView().setModel(Model, \"View\");\r\n\t\tthis.getRouter().getRoute(\"main\").attachPatternMatched(this.onPatternMatched, this);\r\n\r\n\t\tvar inputG = this.byId(\"productInput\") as Input\r\n\t\tvar inputF = this.byId(\"factoryInput\") as Input\r\n\t\tinputG.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t\tinputF.setFilterFunction(function (sTerm: string, oItem:SuggestionItem) {\r\n\t\t\treturn oItem.getText().match(new RegExp(\"^\"+sTerm, \"i\"));\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPatternMatched(event: Event): void {\r\n\t\tvar Model = new JSONModel()\r\n\t\tModel.setData(this.getData())\r\n\t\tthis.getView().setModel(Model, \"Data\")\r\n\r\n\t\tvar ViewModel = this.getView().getModel(\"View\") as JSONModel;\r\n\r\n\t\ttry {\r\n\t\t\tvar query = event.getParameter(\"arguments\")[\"?query\"];\r\n\t\t\tif (query.factory) {\r\n\t\t\t\tViewModel.setProperty(\"/Factory\", query.factory.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitFactory(event);\r\n\t\t\t}\r\n\t\t\tif (query.good) {\r\n\t\t\t\tViewModel.setProperty(\"/Product\", query.good.replace(\"%2520\", \" \"));\r\n\t\t\t\tthis.submitGood(event);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\tpublic submitGood(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Product = Data.getProduct(Model.getProperty(\"/Product\"));\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", Product.Illegal);\r\n\t\tModel.setProperty(\"/Dangerous\", Product.Dangerous);\r\n\t\tModel.setProperty(\"/AvgPrice\", Product.AvgPrice);\r\n\t\tModel.setProperty(\"/Level\", Product.Level);\r\n\t\tModel.setProperty(\"/BoughtBy\", Data.getCustomersOfProduct(Product.Name));\r\n\t\tModel.setProperty(\"/ProducedBy\", Data.getFactoriesFromProduct(Product.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tgood: Model.getProperty(\"/Product\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic submitFactory(event: Event): void {\r\n\t\tvar Data = this.getData();\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar Factory = Data.getFactory(Model.getProperty(\"/Factory\"));\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", Factory.Cost);\r\n\t\tModel.setProperty(\"/ProductionCap\", Factory.ProductionCap);\r\n\t\tModel.setProperty(\"/Materials\", Data.getMaterialsForFactory(Factory.Name));\r\n\t\tModel.setProperty(\"/Products\", Data.getProductsFromFactory(Factory.Name));\r\n\r\n\t\tthis.getRouter().navTo(\"main\", {query: {\r\n\t\t\tfactory: Model.getProperty(\"/Factory\")\r\n\t\t\t}}, {}, true)\r\n\t}\r\n\tpublic onSelectNewFactory(event: Event, Factory: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Factory\", Factory);\r\n\t\tthis.submitFactory(event);\r\n\t}\r\n\tpublic onSelectNewProduct(event: Event, Product: string) {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tModel.setProperty(\"/Product\", Product);\r\n\t\tthis.submitGood(event);\r\n\t}\r\n\tpublic FormatCredits(number: float): string{\r\n\t\tvar format: NumberFormat = NumberFormat.getIntegerInstance({\r\n\t\t\tgroupingEnabled: true,\r\n\t\t\tgroupingSize: 3,\r\n\t\t\tgroupingSeparator: \",\"\r\n\t\t});\r\n\t\treturn format.format(number);\r\n\t}\r\n\tpublic showAllProducts(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", false);\r\n\t\tModel.setProperty(\"/isFactory\", true);\r\n\t\tModel.setProperty(\"/Cost\", \"\");\r\n\t\tModel.setProperty(\"/ProductionCap\", \"\");\r\n\t\tModel.setProperty(\"/Materials\", []);\r\n\t\tvar data = that.getData().Goods;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/Products\", data);\r\n\t}\r\n\tpublic showAllFactories(event: Event): void {\r\n\t\tvar Model = this.getView().getModel(\"View\") as JSONModel;\r\n\t\tvar that = this;\r\n\t\tModel.setProperty(\"/isProduct\", true);\r\n\t\tModel.setProperty(\"/isFactory\", false);\r\n\t\tModel.setProperty(\"/Illegal\", false);\r\n\t\tModel.setProperty(\"/Dangerous\", false);\r\n\t\tModel.setProperty(\"/AvgPrice\", \"\");\r\n\t\tModel.setProperty(\"/Level\", \"\");\r\n\t\tModel.setProperty(\"/BoughtBy\", []);\r\n\t\tvar data = that.getData().Factories;\r\n\t\t//console.log(data);\r\n\t\tModel.setProperty(\"/ProducedBy\", data);\r\n\t}\r\n}\r\n"],"mappings":"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"}